--VALIDACION DE DISPONIBILIDAD
SELECT
  CICLO AS L_O_TDE,
  ROUND(
    SUM(DECODE(PERIODO, '202511',MONTOFACTURADO,0)),
    2
  ) P_202511,
  ROUND(
    SUM(DECODE(PERIODO, '202512',MONTOFACTURADO,0)),
    2
  ) P_202512,
  ROUND(
    SUM(DECODE(PERIODO, '202601',MONTOFACTURADO,0)),
    2
  ) P_202601
FROM ODS_CDG.Cg_Convergente_B2b
WHERE 1=1
  AND PERIODO >= '202501'
  AND FLAG_FUENTE IN ('L','O','ET')
GROUP BY CICLO
;

--VALIDACION DE DISPONIBILIDAD LEGADO Y OCC
SELECT
  CICLO AS L_O,
  ROUND(
    SUM(DECODE(PERIODO, '202511',MONTOFACTURADO,0)),
    2
  ) P_202511,
  ROUND(
    SUM(DECODE(PERIODO, '202512',MONTOFACTURADO,0)),
    2
  ) P_202512,
  ROUND(
    SUM(DECODE(PERIODO, '202601',MONTOFACTURADO,0)),
    2
  ) P_202601
FROM ODS_CDG.Cg_Convergente_B2b
WHERE 1=1
  AND PERIODO >= '202501'
  AND FLAG_FUENTE IN ('L','O')
GROUP BY CICLO
;

--VALIDACION DE DISPONIBILIDAD LEGADO
SELECT
  CICLO AS L,
  ROUND(
    SUM(DECODE(PERIODO, '202511',MONTOFACTURADO,0)),
    2
  ) P_202511,
  ROUND(
    SUM(DECODE(PERIODO, '202512',MONTOFACTURADO,0)),
    2
  ) P_202512,
  ROUND(
    SUM(DECODE(PERIODO, '202601',MONTOFACTURADO,0)),
    2
  ) P_202601
FROM ODS_CDG.Cg_Convergente_B2b
WHERE 1=1
  AND PERIODO >= '202501'
  AND FLAG_FUENTE IN ('L')
GROUP BY CICLO
;

--VALIDACION DE DISPONIBILIDAD OCC
SELECT
  CICLO AS O,
  ROUND(
    SUM(DECODE(PERIODO, '202511',MONTOFACTURADO,0)),
    2
  ) P_202511,
  ROUND(
    SUM(DECODE(PERIODO, '202512',MONTOFACTURADO,0)),
    2
  ) P_202512,
  ROUND(
    SUM(DECODE(PERIODO, '202601',MONTOFACTURADO,0)),
    2
  ) P_202601
FROM ODS_CDG.Cg_Convergente_B2b
WHERE 1=1
  AND PERIODO >= '202501'
  AND FLAG_FUENTE IN ('O')
GROUP BY CICLO
;

--VALIDACION DE DISPONIBILIDAD TDE
SELECT
  CICLO AS TDE,
  ROUND(
    SUM(DECODE(PERIODO, '202511',MONTOFACTURADO,0)),
    2
  ) P_202511,
  ROUND(
    SUM(DECODE(PERIODO, '202512',MONTOFACTURADO,0)),
    2
  ) P_202512,
  ROUND(
    SUM(DECODE(PERIODO, '202601',MONTOFACTURADO,0)),
    2
  ) P_202601
FROM ODS_CDG.Cg_Convergente_B2b
WHERE 1=1
  AND PERIODO >= '202501'
  AND FLAG_FUENTE IN ('ET')
GROUP BY CICLO
;

--VALIDACION DE DISPONIBILIDAD T
SELECT
  CICLO AS T,
  ROUND(
    SUM(DECODE(PERIODO, '202511',MONTOFACTURADO,0)),
    2
  ) P_202511,
  ROUND(
    SUM(DECODE(PERIODO, '202512',MONTOFACTURADO,0)),
    2
  ) P_202512,
  ROUND(
    SUM(DECODE(PERIODO, '202601',MONTOFACTURADO,0)),
    2
  ) P_202601
FROM ODS_CDG.Cg_Convergente_B2b
WHERE 1=1
  AND PERIODO >= '202501'
  AND FLAG_FUENTE IN ('T')
GROUP BY CICLO
;
